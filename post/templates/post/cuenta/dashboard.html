{% extends "post/base.html" %}
{% load static %}

{% block title %}Panel de Cuenta - {{ block.super }}{% endblock %}

{% block header_banner %}
<section class="page-banner">
    <div class="container">
        <h1>Mi Cuenta</h1>
    </div>
</section>
{% endblock %}

{% block extra_css %}
    {% include "post/cuenta/_account_styles.html" %}
{% endblock %}

{% block content %}
<div class="account-container">
    <div class="account-grid">
        {% include "post/cuenta/_sidebar.html" with active_tab="dashboard" %}

        <main class="account-content">
            <section class="welcome-box">
                <h2>¡Hola, {{ cliente.nombre|default:request.user.username }}!</h2>
                <p>Bienvenido a tu panel de cuenta. Desde aquí puedes ver tus pedidos recientes, gestionar tu información personal y más.</p>
            </section>

            <section>
                <h3>Últimos Pedidos</h3>
                {% if ultimos_pedidos %}
                    <table class="recent-orders-table">
                        <thead>
                            <tr>
                                <th>Nº Pedido</th>
                                <th>Fecha</th>
                                <th>Total</th>
                                <th>Estado</th>
                                <th>Acción</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for pedido_obj in ultimos_pedidos %}
                            <tr>
                                <td>
                                    <a href="{% url 'tienda:detalle_pedido_cliente' pedido_id=pedido_obj.id %}">
                                        {{ pedido_obj.codigo }}
                                    </a>
                                </td>
                                <td>{{ pedido_obj.creado|date:"d M Y" }}</td>
                                <td>{{ pedido_obj.total|floatformat:2 }} {{moneda_simbolo|default:'$'}}</td>
                                <td>{{ pedido_obj.get_estado_display }}</td>
                                <td>
                                    <a href="{% url 'tienda:detalle_pedido_cliente' pedido_id=pedido_obj.id %}">
                                        Ver Detalles
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p>Aún no has realizado ningún pedido.</p>
                {% endif %}
                <div class="quick-links">
                    <a href="{% url 'tienda:lista_pedidos_cliente' %}">Ver todos los pedidos</a>
                </div>
            </section>

            <hr class="section-divider" style="margin: 30px 0; border: 0; border-top: 1px solid var(--color-medium-gray);">

            <section class="info-section">
                 <h3>Información de Contacto</h3>
                 <p><strong>Nombre:</strong> {{ cliente.nombre_completo|default:"No especificado" }}</p>
                 <p><strong>Email:</strong> {{ cliente.email|default:request.user.email }}</p>
                 <p><strong>Teléfono:</strong> {{ cliente.telefono|default:"No especificado" }}</p>
                 <div class="quick-links info-quick-links">
                     <a href="{% url 'tienda:editar_perfil_cliente' %}">Editar información</a>
                 </div>
            </section>
        </main>
    </div>
</div>
{% endblock %}
